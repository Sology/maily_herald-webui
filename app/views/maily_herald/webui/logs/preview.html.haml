- content_for :modal_title do
  = t(".title")

.box.noborder
  .dl-horizontal
    %dt= tw("attributes.mailing")
    %dd= friendly_name @log.mailing
    %dt= tw("attributes.entity")
    %dd= @log.entity
    %dt= tw("logs.processing_at")
    %dd= @log.processing_at.try(:in_time_zone)
    %dt= tw("logs.state")
    %dd= display_log_status @log, true

    - if @log.delivered? && @log.opens.list.any?
      %dt= tw("logs.opens")
      %dd.opens-list= display_opens_for @log
    - if (@log.delivered? || @log.error?) && @log.delivery_attempts.list.any?
      %dt= tw("logs.delivery_attempts")
      %dd.delivery-attempts-list= display_delivery_attempts_for @log

  - if @log.scheduled?
    %br
    .dl-horizontal
      - if @log.mailing.has_conditions?
        %dt= tw("attributes.conditions")
        %dd= display_mailing_conditions_status @log.mailing, @log.entity
      %dt
        = tw("attributes.in_scope")
        = display_help_icon :in_scope, scope: "lists"
      %dd= display_list_scope_status @log.mailing.list, @log.entity

- if @log.error?
  .alert.alert-danger= tw("logs.infos.error")
  - if @log.data[:msg]
    %pre= @log.data[:msg]

- elsif @log.skipped?
  - if @log.data[:skip_reason]
    .box.noborder
      .dl-horizontal
        %dt= tw("logs.data.skip_reason")
        %dd= display_log_skip_reason(@log.data[:skip_reason])

- else
  - if @log.scheduled?
    .alert.alert-info
      %p= tw("logs.infos.scheduled")
      - if @log.mailing.has_conditions?
        %p= tw("logs.infos.conditions")

  .log-previews= render_preview

- if (@log.skipped? || @log.scheduled?) && @log.delivery_attempts.list_by(:postpone).any?
  .alert.alert-info
    %p= tw("logs.infos.original_processing", date: @log.data[:original_processing_at].try(:in_time_zone))
    %p= tw("logs.infos.last_skipped", date: @log.delivery_attempts.list_by(:postpone).last[:date_at], reason: display_log_skip_reason(@log.delivery_attempts.list_by(:postpone).last[:reason]))
